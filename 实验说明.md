# 中值滤波水印-数据集保护
## 实验设置
### 数据集准备：
选择CIFAR-10数据集D<sub>u</sub>作为实验对象。

### 水印数据集生成：
将CIFAR-10数据集中的所有数据都进行核为3的中值滤波，采用cv2中的medianBlur函数生成滤波后的图像，构建水印数据集D<sub>a</sub>。

## 实验步骤：
采用CNN训练分类网络，分别用原始数据集D<sub>u</sub>和水印数据集D<sub>a</sub>训练两个相同任务的分类模型M<sub>u</sub>和M<sub>a</sub>。（train_user_medianfiltering.py）

分别将D<sub>u</sub>和D<sub>a</sub>的数据输入对应模型进行预测，将预测概率向量（10维）输出到：test_predictions_with_labels_median_filter，test_predictions_with_labels，
train_predictions_with_labels_median_filter，
train_predictions_with_labels四个文件中。（train_user_medianfiltering.py）

以训练集预测概率向量作为输入，输出为数据是否为水印数据的1/0标签，采用线性分类训练一个二分类器。利用测试集测试准确率。(classifier.py)


## 实验分析：
图像识别模型训练的准确率不是很高，只有46%左右。

在将数据进行模型预测产生预测概率向量之后，原有数据的很多特征在预测概率向量中并没有很好地体现，在这种情况下训练的分类器，并不能很好地将原始数据产生的预测概率向量和水印数据产生的预测概率向量进行区分。

## 改进方案：
改进图像分类模型训练的方法，怎么修改能够提高准确率？

将预测概率向量换为图像进行分类模型的训练，把线性分类模型换为CNN进行训练。





